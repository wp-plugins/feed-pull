(function(e,n,a){"use strict";var t=function(){function t(){function t(){return h.find("tr").last().attr("data-mapping-row-id")}function i(){return v.find("tr").last().attr("data-namespace-row-id")}function p(){e(this).parents("tr").fadeOut().remove()}function o(){function n(){e(this).remove(),1>v.find("tr").length&&_.hide()}e(this).parents("tr").fadeOut(400,n)}function c(){var e=parseInt(t())+1,a=n.template(j,{rowID:e},l);h.append(a)}function r(){var e=parseInt(i())+1,a=n.template(b,{rowID:e,namespace_prefix:"",namespace_url:""},l);v.append(a),_.show()}function s(){x.animate({opacity:1}),e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"pull",nonce:a.pull_nonce,source_feed_id:y.val()}}).always(function(){x.animate({opacity:0})})}function u(){e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"get_namespaces",nonce:a.get_namespaces_nonce,feed_url:I.val()}}).done(function(t){if(I.val()!==k)if(t.namespaces&&t.namespaces[""]!==undefined){m.html(a.unprefixed_root_namespace);var p=!0;if(v.find("input[type=text]").each(function(){("default"==e(this).val()||e(this).val()==t.namespaces[""])&&(p=!1)}),p){var o=parseInt(i())+1,c=n.template(b,{rowID:o,namespace_prefix:"default",namespace_url:t.namespaces[""]},l);v.append(c),_.show()}}else m.html(a.prefixed_root_namespace)}).always(function(){k=I.val()})}var f=e("#fp_field_mapping"),d=e("#fp_source_details"),m=d.find(".custom-namespaces-description"),_=d.find("table"),v=_.find("tbody"),w=f.find("table"),h=w.find("tbody"),g=e("#fp_manual_pull"),y=e("#post_ID"),x=e("#fp-spinner"),I=e("#fp_feed_url"),j=e("#mapping-row-template").html(),b=e("#namespace-row-template").html();e("#log-item-template").html();var k=null;u(),w.on("click","input.delete",p),f.on("click","input.add-new",c),_.on("click","input.delete",o),d.on("click","input.add-new",r),I.on("blur",u),g.on("click",s)}function i(){return null===p&&(p=new t),p}var p=null,l={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return{getInstance:i}}();t.getInstance()})(jQuery,_,FP_Settings,window);